package Portal2D;

import java.awt.Color;
import java.awt.Graphics;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;

public class Block {
	int x,y,width,height;
	int time = 0;
	int gifcounter = 0;
	boolean portalable = true;

	Blocktype special = Blocktype.Normal; // is an enum instead of null to avoid nullPointerExceptions
	Color color = Colors.lightGrey;
	public boolean isOnButton = false;
	boolean upright;
	BufferedImage[] lavagif = new BufferedImage[25];
	BufferedImage Als1e,Als2e,Als3e,Als4e,Als5e,Als6e,Als7e,Als8e,Als9e,Als10e,Als11e,Als12e,Als13e,Als14e,Als15e,Als16e,Als17e,Als18e,Als19e,Als20e,Als21e,Als22e,Als23e,Als24e,Als25e;
	BufferedImage walltexture;
	//BufferedImage buttonPressed, buttonUnpressed; goeie sprites nodig
	
	public void Lava(int x,int y) {
		this.x = x;
		this.y = y;

		try {
			for (int i=0;i<25;i++) {
				lavagif[i] = ImageIO.read(new File("Resources/Images/lava met bellengif Als "+Integer.toString(i+1)+"e.png"));
			
			}
			} catch(IOException ex) {
			System.out.println("gif load failed: lava");
		}
		
	}
	
	public void Texture1(int x,int y) {
		this.x = x;
		this.y = y;

		try {
			walltexture = ImageIO.read(new File("Resources/Images/texture 1.png"));
			} catch(IOException ex) {
			System.out.println("image load failed: texture1");
		}

	}
	public void Texture2(int x,int y) {
		this.x = x;
		this.y = y;

		try {
			walltexture = ImageIO.read(new File("Resources/Images/texture 2.png"));
			} catch(IOException ex) {
			System.out.println("image load failed: texture2");
		}

	}
	
	public void Gatetexture(int x,int y) {
		this.x = x;
		this.y = y;

		try {
			if (upright) {
				walltexture = ImageIO.read(new File("Resources\\Images\\GatewayVertical(50x50).png"));
			} else {
				walltexture = ImageIO.read(new File("Resources\\\\Images\\\\GatewayHorizontal(50x50).png"));
			}
			} catch(IOException ex) {
			System.out.println("image load failed: GatewayVertical");
		}
	}
	

//	public void Button(int x,int y) {
//		this.x = x;
//		this.y = y;
//		
//		try {
//			buttonPressed = ImageIO.read(new File("Resources/Images/buttonPressed.png"));
//			buttonUnpressed = ImageIO.read(new File("Resources/Images/buttonUnpressed.png"));
//			} catch(IOException ex) {
//			System.out.println("image load failed");
//		}
//		
//	}


	
	Block(int x, int y,int width,int height) {
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		
		Texture1(x,y);
		for (int i=0; i<width/50;i++) {
			for (int j=0; j<height/50;j++) {
			Games.level.add(new Block(x+i*50,y+j*50,0,50));
			}
		}
		
	}
	Block(int x, int y,int width,int height,Blocktype special) {
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		
		this.special = special;
		if (special == Blocktype.Endzone) {//finish, end of level
			this.color = Colors.nuclearGreen;
		} else if (special == Blocktype.Lava) {//lava, kills Chell
			Lava(x,y);
			for (int i=0; i<width/50;i++) {
				Games.level.add(new Block(x+i*50,y,0,50,Blocktype.Lava));
			}
			portalable = false;
		
			
		} else if (special== Blocktype.Allergic) {//floors that don't take portals
			Texture2(x,y);
			for (int i=0; i<width/50;i++) {
				for (int j=0; j<height/50;j++) {
					Games.level.add(new Block(x+i*50,y+j*50,0,50,Blocktype.Allergic));
				}
			}
			portalable = false;
		} else if (special == Blocktype.Button) {//it's a button
			this.color = Colors.buttonYellow;
			portalable = false;
		} else if (special == Blocktype.ButtonListener) {//changes if isOnButton is active
			if (height>width) {
				this.upright = true;
			} else {
				this.upright = false;
			}
			Games.level.add(new Block(x,y,width,height,upright));
	}
	}
		
	

	Block(int x, int y,int width,int height,boolean upright) {
		this.x = x;
		this.y = y;
		this.width = width;
		this.height = height;
		this.upright = upright;
		this.special = Blocktype.ButtonListener;
		Gatetexture(x,y);
		for (int i=0; i<height/50;i++) {
			for (int j=0;j<width/50;j++) {
				Games.level.add(new Block(x+j*50,y+i*50,0,0,upright));
				}
			}
		portalable = false;
		}
	
	public Direction intersect(Point point,int targetheight) {
		if (point.y+targetheight <= y) {
			return Direction.Up;
		} else if (point.y >= y+height) {
			return Direction.Down;
		} else if (point.x < x+width/2) {
			return Direction.Left;
		} else {
			return Direction.Right;
		}
	}
	
	public void draw(Graphics g,int tick) {
		if (special.equals(Blocktype.ButtonListener) && Mainpanel.someoneOnButton) {
		}
		
		
		else if (special.equals(Blocktype.Lava)) {		
			if((tick-time) % 2 == 0) {
				gifcounter++;
			}
			if (gifcounter >= 25) {
				gifcounter = 0;
				time = tick;
			}
			g.drawImage(lavagif[gifcounter],x,y,null);
		} else if (color.equals(Colors.lightGrey)) {
			g.drawImage(walltexture, x, y, null);
//		} else if (special.equals("button")) {
//			if (isOnButton) {
//				g.drawImage(buttonPressed, x, y-10, null);
//			} else if (!isOnButton){
//				g.drawImage(buttonUnpressed, x, y-30, null);
//			}
		} else {
		g.setColor(color);
		g.fillRect(x, y, width, height);
		}
	}
	
}
